import numpy as np
import matplotlib.pyplot as plt
from sklearn.metrics import r2_score
from scipy.optimize import curve_fit
from math import ceil
from util import get_json, save_json

def fitGraph (x, y, d, name):
    
    p = np.polyfit(x, y, d)

    xx = np.linspace(x[0], x[-1], len(x))

    print(f"{name} = np.{repr(p)}")
    print(f"# r² : {r2_score(y, np.polyval(p, xx))}")

    plt.scatter(x, y, c='k')
    plt.plot(xx, np.polyval(p, xx), 'r')
    plt.show()
    return

def multifit (var, d, *curves):
    '''
    Realiza a interpolação de coeficientes de várias curvas
        var : valor que a variavel que a curva representa possui
        d : grau do polinopmio da interpolação
        curves : curvas utilizadas, na mesma ordem de seus respectivos valores em "var"
    '''
    fig, ax = plt.subplots(ceil(len(curves[0])/2), 2)
    
    # nomeia automaticamente as variáveis (a, b, c...)
    var_name = [chr(97 + i) for i in range(len(var))]

    x = np.linspace(np.min(var), np.max(var), 10*len(var))

    for i in range(len(curves[0])):

        # todos os coeficientes da mesma posição de todas as curvas
        v = [curves[j][i] for j in range(len(var))]

        p = np.polyfit(var, v, d)   # fit polinomial

        # print em sintaxe pronta para copiar e colar
        print(f"{var_name[i]} = np.polyval(np.{repr(p)}, var)")
        print(f"# r² : {r2_score(v, np.polyval(p, var))}\n")

        # plot para avaliação de como ficou o polyfit
        ax[i//2][i%2].scatter(var, v, c="k")
        ax[i//2][i%2].plot(x, np.polyval(p, x), "r")
        ax[i//2][i%2].set(xlabel= "$\lambda$", ylabel = f"{var_name[i]}($\lambda$)")
    
    plt.show()
    return

def save_coefs (popt, varname, filename):
    try:
        data = get_json(filename)  # tenta ler dados do arquivo
    except:
        data = {}   # cria dicionario caso não exista
    
    data[varname] = list(popt)  # salva dados no dicionário

    save_json(data, filename)   # salva dados de volta no arquivo
    print(f"File {filename} Saved\n")
    return

if __name__ == "__main__":
    ## CL_d teorico====================================================================================
    # tc_015 = [0.06377551020408163, 0.0663265306122449, 0.07142857142857142, 0.07568027210884354, 0.07993197278911564, 0.08418367346938775, 0.08928571428571429, 0.09608843537414966, 0.09948979591836735, 0.10459183673469387, 0.11054421768707483, 0.1173469387755102, 0.12244897959183673, 0.12670068027210885, 0.1292517006802721, 0.1335034013605442, 0.13945578231292516, 0.14370748299319727, 0.1488095238095238, 0.15391156462585034, 0.15986394557823128, 0.16326530612244897, 0.1683673469387755, 0.1717687074829932, 0.1760204081632653, 0.179421768707483, 0.1845238095238095, 0.18962585034013604, 0.19302721088435373, 0.19812925170068027, 0.20153061224489796, 0.20493197278911565, 0.20833333333333331, 0.21343537414965985, 0.21683673469387754, 0.22023809523809523, 0.2261904761904762, 0.23299319727891155, 0.2389455782312925, 0.2423469387755102, 0.2457482993197279, 0.25, 0.25510204081632654, 0.2627551020408163, 0.2627551020408163, 0.26870748299319724, 0.2755102040816326, 0.27976190476190477, 0.28401360544217685, 0.29166666666666663, 0.298469387755102, 0.304421768707483, 0.30952380952380953, 0.3129251700680272, 0.3180272108843537, 0.32312925170068024, 0.3273809523809524, 0.3333333333333333, 0.3409863945578231, 0.34608843537414963, 0.35034013605442177, 0.3554421768707483, 0.36139455782312924, 0.3656462585034013, 0.36989795918367346, 0.37670068027210885, 0.3818027210884354, 0.3869047619047619, 0.391156462585034, 0.3945578231292517, 0.39965986394557823, 0.40221088435374147, 0.407312925170068, 0.4115646258503401, 0.4175170068027211, 0.42176870748299317, 0.4260204081632653, 0.43112244897959184, 0.4370748299319728, 0.4430272108843537, 0.4498299319727891, 0.4557823129251701, 0.4625850340136054, 0.4693877551020408, 0.4744897959183673, 0.47959183673469385, 0.4855442176870748, 0.49234693877551017]
    # Cldt_015 = [2.0085653104925054, 2.068522483940043, 2.119914346895075, 2.2055674518201283, 2.274089935760171, 2.3340471092077086, 2.4197002141327624, 2.4882226980728053, 2.565310492505353, 2.6167023554603857, 2.685224839400428, 2.7794432548179873, 2.8308351177730193, 2.8822269807280514, 2.9507494646680943, 2.985010706638116, 3.0535331905781584, 3.104925053533191, 3.1563169164882225, 3.207708779443255, 3.267665952890792, 3.3190578158458246, 3.3618843683083512, 3.404710920770878, 3.4561027837259104, 3.4989293361884366, 3.5588865096359745, 3.6102783725910066, 3.6531049250535332, 3.687366167023555, 3.721627408993576, 3.7558886509635974, 3.80728051391863, 3.8329764453961457, 3.8843683083511777, 3.9186295503211994, 3.961456102783726, 4.029978586723769, 4.072805139186295, 4.115631691648822, 4.149892933618844, 4.201284796573876, 4.235546038543897, 4.30406852248394, 4.30406852248394, 4.346895074946467, 4.398286937901499, 4.449678800856532, 4.492505353319058, 4.54389721627409, 4.595289079229122, 4.638115631691649, 4.680942184154176, 4.715203426124197, 4.758029978586723, 4.809421841541756, 4.835117773019272, 4.869379014989294, 4.920770877944326, 4.963597430406852, 4.997858672376873, 5.0235546038543895, 5.0663811563169165, 5.109207708779444, 5.152034261241971, 5.177730192719486, 5.203426124197002, 5.2462526766595285, 5.28051391862955, 5.314775160599572, 5.323340471092077, 5.366167023554604, 5.391862955032121, 5.417558886509636, 5.451820128479658, 5.477516059957173, 5.511777301927195, 5.537473233404711, 5.563169164882227, 5.61456102783726, 5.657387580299786, 5.683083511777302, 5.725910064239828, 5.76017130620985, 5.802997858672377, 5.828693790149893, 5.8715203426124205, 5.8886509635974305]

    # fitGraph (tc_015, Cldt_015, 3, "Cldt_015")

    # tc_0 = [0.07908163265306122, 0.08163265306122448, 0.0858843537414966, 0.08843537414965986, 0.09353741496598639, 0.09863945578231292, 0.10374149659863945, 0.10714285714285714, 0.11224489795918367, 0.11649659863945577, 0.12159863945578231, 0.12670068027210885, 0.1326530612244898, 0.1377551020408163, 0.14370748299319727, 0.1488095238095238, 0.15391156462585034, 0.157312925170068, 0.16241496598639454, 0.16581632653061223, 0.17091836734693877, 0.17431972789115646, 0.17857142857142858, 0.1845238095238095, 0.18962585034013604, 0.19387755102040816, 0.1989795918367347, 0.20408163265306123, 0.20918367346938774, 0.21343537414965985, 0.2185374149659864, 0.2261904761904762, 0.2312925170068027, 0.23724489795918366, 0.2423469387755102, 0.24914965986394558, 0.25595238095238093, 0.2619047619047619, 0.26785714285714285, 0.2729591836734694, 0.2780612244897959, 0.2848639455782313, 0.29166666666666663, 0.298469387755102, 0.3018707482993197, 0.30612244897959184, 0.3112244897959184, 0.31632653061224486, 0.32227891156462585, 0.3282312925170068, 0.33418367346938777, 0.33928571428571425, 0.34523809523809523, 0.35119047619047616, 0.358843537414966, 0.3664965986394558, 0.37329931972789115, 0.38010204081632654, 0.3869047619047619, 0.391156462585034, 0.39625850340136054, 0.40221088435374147, 0.40901360544217685, 0.4149659863945578, 0.42091836734693877, 0.4260204081632653, 0.43112244897959184, 0.4370748299319728, 0.4430272108843537, 0.44727891156462585, 0.45153061224489793, 0.4583333333333333, 0.4659863945578231, 0.4727891156462585, 0.47959183673469385, 0.4855442176870748, 0.4931972789115646]
    # Cldt_0 = [2.188436830835118, 2.23982869379015, 2.274089935760171, 2.3340471092077086, 2.394004282655246, 2.436830835117773, 2.505353319057816, 2.5481798715203428, 2.599571734475375, 2.650963597430407, 2.6937901498929335, 2.7366167023554606, 2.805139186295503, 2.8565310492505356, 2.9079229122055676, 2.9593147751605997, 2.993576017130621, 3.044967880085653, 3.0706638115631693, 3.1220556745182013, 3.1563169164882225, 3.190578158458244, 3.2162740899357605, 3.267665952890792, 3.310492505353319, 3.344753747323341, 3.387580299785867, 3.4389721627408996, 3.481798715203426, 3.5417558886509637, 3.56745182012848, 3.6102783725910066, 3.6616702355460387, 3.6959314775160603, 3.747323340471092, 3.7987152034261245, 3.8329764453961457, 3.8758029978586723, 3.927194860813705, 3.961456102783726, 4.0214132762312635, 4.047109207708779, 4.089935760171306, 4.124197002141328, 4.167023554603855, 4.192719486081371, 4.235546038543897, 4.252676659528908, 4.278372591006424, 4.329764453961456, 4.346895074946467, 4.389721627408994, 4.4239828693790155, 4.449678800856532, 4.483940042826553, 4.518201284796574, 4.578158458244111, 4.595289079229122, 4.629550321199144, 4.6638115631691655, 4.689507494646682, 4.715203426124197, 4.740899357601713, 4.7837259100642395, 4.80085653104925, 4.835117773019272, 4.8436830835117775, 4.869379014989294, 4.903640256959315, 4.929336188436832, 4.955032119914347, 4.980728051391863, 5.006423982869379, 5.0406852248394, 5.057815845824411, 5.083511777301927, 5.117773019271949]

    # fitGraph (tc_0, Cldt_0, 3, "Cldt_0")

    # tc_006 = [0.2568027210884354, 0.2619047619047619, 0.266156462585034, 0.27210884353741494, 0.2780612244897959, 0.28401360544217685, 0.29081632653061223, 0.2976190476190476, 0.3010204081632653, 0.30697278911564624, 0.3129251700680272, 0.31887755102040816, 0.3239795918367347, 0.3307823129251701, 0.3358843537414966, 0.34183673469387754, 0.3486394557823129, 0.35459183673469385, 0.3622448979591837, 0.369047619047619, 0.37755102040816324, 0.3835034013605442, 0.391156462585034, 0.39710884353741494, 0.4039115646258503, 0.41241496598639454, 0.4183673469387755, 0.42517006802721086, 0.429421768707483, 0.43537414965986393, 0.44132653061224486, 0.4464285714285714, 0.4523809523809524, 0.4574829931972789, 0.46428571428571425, 0.47023809523809523, 0.47619047619047616, 0.48214285714285715, 0.4880952380952381, 0.49489795918367346]
    # Cldt_006 = [3.9957173447537473, 4.029978586723769, 4.072805139186295, 4.124197002141328, 4.167023554603855, 4.218415417558887, 4.2612419700214135, 4.30406852248394, 4.346895074946467, 4.381156316916488, 4.41541755888651, 4.449678800856532, 4.492505353319058, 4.518201284796574, 4.569593147751606, 4.612419700214133, 4.65524625267666, 4.698072805139186, 4.732334047109208, 4.7837259100642395, 4.826552462526767, 4.852248394004283, 4.912205567451821, 4.937901498929336, 4.972162740899358, 5.014989293361884, 5.057815845824411, 5.083511777301927, 5.117773019271949, 5.143468950749465, 5.169164882226982, 5.211991434689508, 5.229122055674519, 5.271948608137045, 5.297644539614561, 5.331905781584583, 5.349036402569594, 5.391862955032121, 5.417558886509636, 5.451820128479658]

    # fitGraph (tc_006, Cldt_006, 3, "Cldt_006")

    # tc_01 = [0.25170068027210885, 0.2568027210884354, 0.2619047619047619, 0.26870748299319724, 0.2738095238095238, 0.28061224489795916, 0.28656462585034015, 0.2942176870748299, 0.30017006802721086, 0.30697278911564624, 0.3120748299319728, 0.3180272108843537, 0.32568027210884354, 0.3324829931972789, 0.33843537414965985, 0.3435374149659864, 0.3477891156462585, 0.35374149659863946, 0.3596938775510204, 0.3664965986394558, 0.37329931972789115, 0.37755102040816324, 0.3826530612244898, 0.3886054421768707, 0.3945578231292517, 0.4005102040816326, 0.407312925170068, 0.41241496598639454, 0.4175170068027211, 0.423469387755102, 0.42857142857142855, 0.43537414965986393, 0.439625850340136, 0.44472789115646255, 0.4498299319727891, 0.45663265306122447, 0.46343537414965985, 0.47023809523809523, 0.477891156462585, 0.4846938775510204, 0.4914965986394558, 0.4965986394557823]
    # Cldt_01 = [4.06423982869379, 4.107066381156317, 4.149892933618844, 4.201284796573876, 4.244111349036403, 4.30406852248394, 4.346895074946467, 4.406852248394005, 4.441113490364026, 4.492505353319058, 4.526766595289079, 4.586723768736617, 4.638115631691649, 4.6638115631691655, 4.7237687366167025, 4.749464668094219, 4.7837259100642395, 4.835117773019272, 4.860813704496788, 4.903640256959315, 4.946466809421842, 4.989293361884369, 5.032119914346895, 5.049250535331906, 5.092077087794433, 5.1263383297644545, 5.160599571734476, 5.194860813704497, 5.229122055674519, 5.263383297644539, 5.289079229122056, 5.331905781584583, 5.366167023554604, 5.383297644539615, 5.417558886509636, 5.443254817987152, 5.494646680942184, 5.5203426124197, 5.571734475374733, 5.597430406852249, 5.631691648822271, 5.6488222698072805]

    # fitGraph (tc_01, Cldt_01, 3, "Cldt_01")

    # fit dos coeficientes de Cldt =============================================================================================
    # Cldt_015 = np.array([ 13.78624775, -21.56185942,  17.18739997,   1.02728285])
    # # r² : 0.9946907350538143

    # Cldt_01 = np.array([ 0.63493929, -7.2730938 , 11.65382782,  1.58511417])
    # # r² : 0.9993434000757871

    # Cldt_006 = np.array([ 19.29148536, -28.13476663,  18.81863419,   0.6930432 ])
    # # r² : 0.9974711743165151

    # Cldt_0 = np.array([  8.84566959, -16.55524344,  13.92124889,   1.21889171])
    # # r² : 0.9835579723985991

    # multifit([0, 0.06, 0.1, 0.15], 3, Cldt_0, Cldt_006, Cldt_01, Cldt_015)
    # cf_c = np.linspace(0, 0.5)
    # plt.plot(cf_c, np.polyval(Cldt_0, cf_c))
    # plt.plot(cf_c, np.polyval(Cldt_01, cf_c))
    # plt.plot(cf_c, np.polyval(Cldt_006, cf_c))
    # plt.plot(cf_c, np.polyval(Cldt_015, cf_c))
    # plt.show()

    ## Cla_t ==========================================================================================
    # tc = [0, 0.0027649769585253456, 0.0052227342549923195, 0.006758832565284178, 0.00890937019969278, 0.011059907834101382, 0.013210445468509985, 0.015360983102918587, 0.017204301075268817, 0.01935483870967742, 0.02119815668202765, 0.023348694316436252, 0.02457757296466974, 0.02642089093701997, 0.02857142857142857, 0.03010752688172043, 0.03225806451612903, 0.034101382488479264, 0.035944700460829496, 0.03840245775729647, 0.040552995391705066, 0.04270353302611367, 0.04423963133640553, 0.04639016897081413, 0.048233486943164365, 0.05038402457757296, 0.052534562211981564, 0.05499231950844854, 0.05745007680491551, 0.059907834101382486, 0.06328725038402458, 0.06574500768049155, 0.06789554531490015, 0.07096774193548387, 0.07311827956989247, 0.0771121351766513, 0.08049155145929339, 0.08356374807987711, 0.08663594470046083, 0.09062980030721966, 0.09554531490015361, 0.10076804915514592, 0.10506912442396313, 0.10506912442396313, 0.10691244239631337, 0.1109062980030722, 0.11336405529953918, 0.11643625192012289, 0.11920122887864823, 0.12227342549923195, 0.12534562211981568, 0.1293394777265745, 0.13302611367127495, 0.13640552995391705, 0.13886328725038402, 0.141321044546851, 0.1434715821812596, 0.14592933947772657, 0.1499231950844854, 0.1499231950844854, 0.1523809523809524, 0.15514592933947774, 0.15821812596006143, 0.16006144393241167, 0.16344086021505377, 0.16589861751152074, 0.1683563748079877, 0.17019969278033795, 0.17204301075268819, 0.1738863287250384, 0.17665130568356374, 0.1794162826420891, 0.18218125960061443, 0.18494623655913978, 0.18678955453149002, 0.18955453149001536, 0.19201228878648233, 0.19416282642089094, 0.19723502304147467, 0.19938556067588326]
    # cla_t = [6.295629820051414, 6.304884318766067, 6.317223650385604, 6.326478149100257, 6.338817480719794, 6.344987146529563, 6.3573264781491, 6.366580976863753, 6.37892030848329, 6.388174807197943, 6.400514138817481, 6.406683804627249, 6.419023136246786, 6.422107969151671, 6.431362467866324, 6.4467866323907455, 6.452956298200514, 6.462210796915167, 6.47146529562982, 6.477634961439589, 6.4961439588688945, 6.499228791773779, 6.508483290488432, 6.5239074550128535, 6.5362467866323914, 6.545501285347044, 6.5516709511568125, 6.56401028277635, 6.573264781491003, 6.591773778920309, 6.604113110539846, 6.619537275064268, 6.628791773778921, 6.647300771208227, 6.653470437017996, 6.671979434447301, 6.690488431876607, 6.712082262210798, 6.724421593830335, 6.742930591259641, 6.767609254498715, 6.789203084832905, 6.804627249357327, 6.804627249357327, 6.829305912596402, 6.844730077120823, 6.85706940874036, 6.869408740359898, 6.881748071979435, 6.897172236503856, 6.909511568123394, 6.9280205655527, 6.946529562982006, 6.958868894601543, 6.974293059125964, 6.995886889460155, 6.998971722365039, 7.005141388174808, 7.032904884318766, 7.032904884318766, 7.048329048843188, 7.060668380462725, 7.073007712082262, 7.088431876606684, 7.094601542416453, 7.110025706940874, 7.12853470437018, 7.131619537275064, 7.134704370179949, 7.153213367609255, 7.156298200514139, 7.174807197943445, 7.184061696658098, 7.19948586118252, 7.211825192802057, 7.227249357326478, 7.236503856041131, 7.255012853470437, 7.267352185089974, 7.270437017994859]

    # fitGraph (tc, cla_t, 1, "cla_t")

    ## ag_Cl ==========================================================================================
    def ag (x, a, b, c):
        return -a*np.log(b*np.array(x) + c)

    # cf_c = [0, 0.0038314176245210726, 0.011494252873563218, 0.01532567049808429, 0.022988505747126436, 0.03065134099616858, 0.034482758620689655, 0.042145593869731796, 0.053639846743295014, 0.06130268199233716, 0.08045977011494253, 0.09195402298850575, 0.10344827586206896, 0.11494252873563218, 0.13409961685823754, 0.1532567049808429, 0.17241379310344826, 0.18773946360153257, 0.21455938697318006, 0.23371647509578544, 0.2567049808429119, 0.2796934865900383, 0.30268199233716475, 0.32950191570881227, 0.3486590038314176, 0.3793103448275862, 0.4061302681992337, 0.4291187739463601, 0.45977011494252873, 0.475095785440613, 0.49425287356321834, 0.5172413793103448, 0.5440613026819923, 0.5708812260536398, 0.5977011494252873, 0.632183908045977, 0.6666666666666666, 0.7049808429118773, 0.739463601532567, 0.7701149425287356, 0.8007662835249042, 0.8314176245210727, 0.8620689655172413, 0.89272030651341, 0.9272030651340996, 0.9616858237547892, 0.9923371647509578]
    # ag_cl = [-0.011406844106463879, -0.045627376425855515, -0.07984790874524715, -0.11787072243346007, -0.1482889733840304, -0.17870722433460076, -0.20912547528517111, -0.23574144486692014, -0.2661596958174905, -0.3041825095057034, -0.3269961977186312, -0.3612167300380228, -0.3916349809885932, -0.4220532319391635, -0.4448669201520912, -0.4752851711026616, -0.49809885931558934, -0.5361216730038023, -0.55893536121673, -0.5893536121673004, -0.6121673003802282, -0.6349809885931559, -0.6653992395437263, -0.6844106463878327, -0.7072243346007605, -0.7300380228136882, -0.7490494296577946, -0.7718631178707225, -0.7832699619771863, -0.8060836501901141, -0.8212927756653993, -0.8250950570342205, -0.8403041825095057, -0.8517110266159695, -0.8745247148288974, -0.8897338403041825, -0.8973384030418251, -0.9125475285171103, -0.9315589353612167, -0.9391634980988594, -0.9505703422053232, -0.9581749049429658, -0.9695817490494296, -0.9771863117870723, -0.9771863117870723, -0.9961977186311787, -0.9961977186311787]

    # popt, _ = curve_fit(ag, cf_c, ag_cl)

    # y = -popt[0]*np.log(popt[1]*np.array(cf_c) + popt[2])

    # print(f"ag_cl = -{popt}*np.log({popt[1]}*cf_c + {popt[2]})")
    # print(f"# r² : {r2_score(ag_cl, y)}")
    # plt.scatter(cf_c, ag_cl, c='k')
    # plt.plot(cf_c, y, 'r')
    # plt.show()

    ## K2 =============================================================================================
    # lmb_0 = [0, 0.004016064257028112, 0.012048192771084336, 0.018072289156626505, 0.028112449799196783, 0.03413654618473895, 0.04618473895582329, 0.05421686746987951, 0.06024096385542168, 0.07429718875502007, 0.08032128514056225, 0.09638554216867469, 0.10441767068273092, 0.1144578313253012, 0.12650602409638553, 0.13855421686746985, 0.1465863453815261, 0.1606425702811245, 0.17068273092369476, 0.18674698795180722, 0.19277108433734938, 0.20481927710843373, 0.214859437751004, 0.22088353413654616, 0.2289156626506024, 0.23895582329317266, 0.2469879518072289, 0.25903614457831325, 0.2690763052208835, 0.2791164658634538, 0.2891566265060241, 0.2971887550200803, 0.3092369477911646, 0.321285140562249, 0.3293172690763052, 0.3373493975903614, 0.34538152610441764, 0.35542168674698793, 0.36746987951807225, 0.37751004016064255, 0.38955823293172687, 0.3975903614457831, 0.40963855421686746, 0.4216867469879518, 0.4337349397590361, 0.4417670682730923, 0.4538152610441767, 0.4618473895582329, 0.4738955823293172, 0.48594377510040154, 0.49598393574297184, 0.5100401606425702, 0.5200803212851405, 0.5341365461847389, 0.5502008032128514, 0.5642570281124497, 0.5763052208835341, 0.5963855421686747, 0.6124497991967871, 0.6285140562248995, 0.644578313253012, 0.6666666666666666, 0.6887550200803212, 0.7048192771084336, 0.716867469879518, 0.7329317269076304, 0.7510040160642569, 0.7630522088353413, 0.7791164658634537, 0.7951807228915662, 0.8132530120481927, 0.8273092369477911, 0.8413654618473895, 0.8574297188755019, 0.8755020080321284, 0.8935742971887549, 0.9176706827309236, 0.9337349397590361, 0.9518072289156626, 0.9718875502008031]
    # k2_0 = [0.0019723865877712033, 0.013806706114398423, 0.02958579881656805, 0.04733727810650888, 0.05719921104536489, 0.07297830374753451, 0.08875739644970415, 0.10256410256410257, 0.1203155818540434, 0.13214990138067062, 0.14792899408284024, 0.16173570019723868, 0.1775147928994083, 0.1913214990138067, 0.20512820512820515, 0.21893491124260356, 0.23471400394477318, 0.252465483234714, 0.26824457593688367, 0.28205128205128205, 0.2978303747534517, 0.3136094674556213, 0.3254437869822485, 0.33530571992110453, 0.34714003944773175, 0.35700197238658776, 0.368836291913215, 0.38461538461538464, 0.39644970414201186, 0.40631163708086787, 0.4181459566074951, 0.4339250493096647, 0.4457593688362919, 0.45759368836291914, 0.46942800788954636, 0.4812623274161736, 0.4930966469428008, 0.5069033530571992, 0.5147928994082841, 0.5266272189349113, 0.5443786982248521, 0.5562130177514794, 0.5641025641025641, 0.5779092702169626, 0.5897435897435898, 0.601577909270217, 0.6134122287968442, 0.6272189349112426, 0.6410256410256411, 0.6489151873767258, 0.6607495069033531, 0.6745562130177515, 0.68836291913215, 0.7041420118343196, 0.7218934911242604, 0.7416173570019724, 0.7554240631163709, 0.7712031558185405, 0.7869822485207101, 0.8027613412228797, 0.8165680473372782, 0.834319526627219, 0.8481262327416174, 0.8599605522682446, 0.873767258382643, 0.8856015779092703, 0.8974358974358975, 0.9053254437869823, 0.9151873767258383, 0.9230769230769231, 0.9368836291913215, 0.9428007889546351, 0.95069033530572, 0.9585798816568047, 0.9664694280078896, 0.9743589743589745, 0.9861932938856016, 0.9921104536489153, 0.990138067061144, 0.9980276134122289]

    # fitGraph(lmb_0, k2_0, 2, "K2_0")

    # lmb_05 = [0, 0.010040160642570281, 0.010040160642570281, 0.018072289156626505, 0.02610441767068273, 0.04216867469879518, 0.04216867469879518, 0.0502008032128514, 0.058232931726907626, 0.0682730923694779, 0.08032128514056225, 0.0823293172690763, 0.09638554216867469, 0.10642570281124497, 0.1184738955823293, 0.13052208835341364, 0.14056224899598393, 0.15261044176706826, 0.1646586345381526, 0.1827309236947791, 0.19076305220883533, 0.20481927710843373, 0.2188755020080321, 0.23092369477911645, 0.24497991967871482, 0.2570281124497992, 0.2730923694779116, 0.285140562248996, 0.2971887550200803, 0.3112449799196787, 0.3253012048192771, 0.3333333333333333, 0.34136546184738953, 0.35341365461847385, 0.36345381526104414, 0.37751004016064255, 0.38554216867469876, 0.39558232931726905, 0.40963855421686746, 0.4216867469879518, 0.4337349397590361, 0.4497991967871485, 0.4598393574297188, 0.4738955823293172, 0.4839357429718875, 0.4979919678714859, 0.5100401606425702, 0.5220883534136546, 0.5301204819277108, 0.5421686746987951, 0.5542168674698794, 0.5682730923694779, 0.5823293172690762, 0.5923694779116465, 0.6024096385542168, 0.6144578313253012, 0.6244979919678715, 0.6365461847389557, 0.6526104417670682, 0.6626506024096385, 0.6746987951807228, 0.6867469879518072, 0.7028112449799196, 0.7148594377510039, 0.7248995983935742, 0.7389558232931727, 0.7510040160642569, 0.7710843373493975, 0.7831325301204819, 0.7971887550200802, 0.8132530120481927, 0.825301204819277, 0.8413654618473895, 0.8574297188755019, 0.8755020080321284, 0.8935742971887549, 0.9096385542168673, 0.931726907630522, 0.9497991967871485, 0.967871485943775]
    # k2_05 = [0.0019723865877712033, 0.021696252465483234, 0.021696252465483234, 0.02958579881656805, 0.04339250493096647, 0.0631163708086785, 0.0631163708086785, 0.07692307692307693, 0.08875739644970415, 0.10256410256410257, 0.11242603550295859, 0.126232741617357, 0.13806706114398423, 0.15187376725838264, 0.16765285996055226, 0.1854043392504931, 0.19921104536489154, 0.21696252465483234, 0.23471400394477318, 0.2504930966469428, 0.26627218934911245, 0.28402366863905326, 0.3037475345167653, 0.3175542406311637, 0.33530571992110453, 0.34911242603550297, 0.36686390532544383, 0.38461538461538464, 0.40236686390532544, 0.4181459566074951, 0.4299802761341223, 0.44181459566074954, 0.45364891518737677, 0.465483234714004, 0.47928994082840237, 0.495069033530572, 0.5029585798816568, 0.5147928994082841, 0.5285996055226825, 0.5443786982248521, 0.5562130177514794, 0.5739644970414202, 0.5897435897435898, 0.601577909270217, 0.6134122287968442, 0.6291913214990138, 0.6449704142011835, 0.6528599605522682, 0.6666666666666667, 0.6785009861932939, 0.6923076923076923, 0.7021696252465484, 0.7159763313609467, 0.727810650887574, 0.7357001972386588, 0.747534516765286, 0.7593688362919132, 0.7731755424063117, 0.7830374753451677, 0.7948717948717949, 0.8086785009861933, 0.8185404339250494, 0.8284023668639053, 0.8422090729783038, 0.8560157790927022, 0.8639053254437871, 0.873767258382643, 0.8875739644970415, 0.8974358974358975, 0.9112426035502958, 0.9191321499013807, 0.9289940828402368, 0.9388560157790927, 0.9487179487179488, 0.9566074950690335, 0.9684418145956608, 0.9743589743589745, 0.9842209072978304, 0.9921104536489153, 0.9960552268244577]

    # fitGraph(lmb_05, k2_05, 3, "K2_05")

    # lmb_1 = [0, 0.010040160642570281, 0.02610441767068273, 0.040160642570281124, 0.04216867469879518, 0.05421686746987951, 0.06224899598393574, 0.07429718875502007, 0.08634538152610441, 0.09236947791164658, 0.10441767068273092, 0.1184738955823293, 0.12650602409638553, 0.1365461847389558, 0.14859437751004015, 0.1606425702811245, 0.1686746987951807, 0.17670682730923692, 0.18875502008032127, 0.19879518072289154, 0.20883534136546184, 0.22088353413654616, 0.23092369477911645, 0.24096385542168672, 0.2550200803212851, 0.2690763052208835, 0.2771084337349397, 0.2891566265060241, 0.3032128514056225, 0.3152610441767068, 0.3293172690763052, 0.33935742971887545, 0.35341365461847385, 0.36345381526104414, 0.37751004016064255, 0.38955823293172687, 0.4056224899598393, 0.4156626506024096, 0.429718875502008, 0.4397590361445783, 0.4538152610441767, 0.465863453815261, 0.4759036144578313, 0.4879518072289156, 0.49598393574297184, 0.5080321285140562, 0.5200803212851405, 0.5341365461847389, 0.5421686746987951, 0.5562248995983935, 0.570281124497992, 0.5843373493975903, 0.5983935742971886, 0.6124497991967871, 0.6224899598393574, 0.6365461847389557, 0.6526104417670682, 0.6666666666666666, 0.6847389558232931, 0.7008032128514056, 0.716867469879518, 0.7329317269076304, 0.7449799196787148, 0.7650602409638554, 0.7811244979919678, 0.7911646586345381, 0.8072289156626505, 0.825301204819277, 0.8433734939759036, 0.8614457831325301, 0.8815261044176707, 0.899598393574297, 0.9156626506024096, 0.9337349397590361, 0.9497991967871485, 0.9738955823293172, 0.9899598393574296]
    # k2_1 = [-0.0019723865877712033, 0.009861932938856016, 0.027613412228796846, 0.04142011834319527, 0.05325443786982249, 0.0650887573964497, 0.07889546351084813, 0.09072978303747535, 0.10650887573964497, 0.1183431952662722, 0.13214990138067062, 0.14792899408284024, 0.15976331360946747, 0.17357001972386588, 0.1873767258382643, 0.19921104536489154, 0.21104536489151876, 0.22287968441814596, 0.2366863905325444, 0.24852071005917162, 0.2603550295857988, 0.27416173570019725, 0.2879684418145957, 0.2998027613412229, 0.3175542406311637, 0.32938856015779094, 0.3431952662721894, 0.35700197238658776, 0.3727810650887574, 0.38856015779092706, 0.40236686390532544, 0.4201183431952663, 0.4358974358974359, 0.4477317554240631, 0.46153846153846156, 0.4773175542406312, 0.4911242603550296, 0.5088757396449705, 0.5207100591715976, 0.5345167652859961, 0.5463510848126233, 0.5601577909270217, 0.5739644970414202, 0.5877712031558185, 0.5996055226824458, 0.611439842209073, 0.6232741617357003, 0.6370808678500987, 0.6528599605522682, 0.6646942800788955, 0.6804733727810651, 0.6923076923076923, 0.708086785009862, 0.7218934911242604, 0.7337278106508877, 0.747534516765286, 0.7613412228796844, 0.7790927021696253, 0.7909270216962525, 0.8067061143984221, 0.8185404339250494, 0.834319526627219, 0.8461538461538461, 0.8599605522682446, 0.8698224852071006, 0.8816568047337279, 0.8954635108481263, 0.9033530571992111, 0.9171597633136095, 0.930966469428008, 0.9408284023668639, 0.95069033530572, 0.9625246548323472, 0.970414201183432, 0.980276134122288, 0.990138067061144, 0.9980276134122289]

    # fitGraph(lmb_1, k2_1, 2, "K2_1")

    # fit dos coeficientes de K2 ===============================================================================================
    # K2_0 = np.array([-0.30326651, -0.16742802,  1.46001205,  0.02070015])
    # # r² : 0.926855137757906

    # K2_05 = np.array([-0.27384951, -0.07201788,  1.35541055,  0.00868353])
    # # r² : 0.9707734775429683

    # K2_1 = np.array([-3.84493899e-01,  1.68648997e-01,  1.21840169e+00,  3.97510259e-04])
    # # r² : 0.9623390915632927

    # multifit ([0, 0.5, 1], 2, K2_0, K2_05, K2_1)

    ## Cl_d_t =========================================================================================
    # cf_c_07 = [0.13368055555555555, 0.13975694444444445, 0.14496527777777776, 0.15104166666666666, 0.15885416666666666, 0.1640625, 0.171875, 0.18229166666666666, 0.1892361111111111, 0.1970486111111111, 0.203125, 0.21006944444444442, 0.21701388888888887, 0.22482638888888887, 0.23263888888888887, 0.23871527777777776, 0.24652777777777776, 0.2543402777777778, 0.2647569444444444, 0.2717013888888889, 0.2795138888888889, 0.2881944444444444, 0.2977430555555555, 0.30729166666666663, 0.3133680555555555, 0.32291666666666663, 0.3298611111111111, 0.3376736111111111, 0.34809027777777773, 0.3550347222222222, 0.36197916666666663, 0.36979166666666663, 0.3767361111111111, 0.38715277777777773, 0.3958333333333333, 0.40277777777777773, 0.41059027777777773, 0.41666666666666663, 0.4253472222222222, 0.43402777777777773, 0.44184027777777773, 0.44791666666666663, 0.4548611111111111, 0.46354166666666663, 0.4704861111111111, 0.4782986111111111, 0.48697916666666663, 0.4939236111111111]
    # Cld_t_07 = [0.3982507288629738, 0.40174927113702624, 0.4034985422740525, 0.41049562682215746, 0.41049562682215746, 0.4157434402332362, 0.41924198250728867, 0.4244897959183674, 0.4262390670553936, 0.4279883381924198, 0.43323615160349854, 0.43848396501457726, 0.43848396501457726, 0.443731778425656, 0.44548104956268225, 0.4489795918367347, 0.4542274052478134, 0.4577259475218659, 0.4577259475218659, 0.4629737609329446, 0.46822157434402334, 0.47172011661807584, 0.47346938775510206, 0.47696793002915455, 0.48221574344023327, 0.4839650145772595, 0.48571428571428577, 0.487463556851312, 0.4962099125364432, 0.4979591836734694, 0.49970845481049564, 0.5032069970845481, 0.5032069970845481, 0.5119533527696793, 0.5137026239067055, 0.5154518950437318, 0.5154518950437318, 0.5189504373177842, 0.524198250728863, 0.5276967930029155, 0.5276967930029155, 0.5294460641399417, 0.5346938775510204, 0.5381924198250729, 0.5381924198250729, 0.5434402332361516, 0.5451895043731778, 0.5486880466472304]

    # fitGraph(cf_c_07, Cld_t_07, 4, "Cld_07")
    # save_coefs([-0.41396058,  0.98766589, -0.89591411,  0.72072819,  0.31629528], "Cld_t_07", "Cld_t")

    # cf_c_098 = [0.051215277777777776, 0.05815972222222222, 0.06510416666666666, 0.07291666666666666, 0.08246527777777778, 0.09114583333333333, 0.09982638888888888, 0.10590277777777778, 0.11458333333333333, 0.12413194444444443, 0.1345486111111111, 0.1423611111111111, 0.1501736111111111, 0.1579861111111111, 0.16493055555555555, 0.1736111111111111, 0.18229166666666666, 0.19270833333333331, 0.20138888888888887, 0.21006944444444442, 0.21875, 0.22569444444444442, 0.23350694444444442, 0.2439236111111111, 0.2517361111111111, 0.2638888888888889, 0.27604166666666663, 0.28385416666666663, 0.29166666666666663, 0.3020833333333333, 0.3133680555555555, 0.32465277777777773, 0.3342013888888889, 0.3446180555555555, 0.3550347222222222, 0.3628472222222222, 0.3723958333333333, 0.3836805555555555, 0.3914930555555555, 0.40104166666666663, 0.4079861111111111, 0.4157986111111111, 0.42621527777777773, 0.43576388888888884, 0.4444444444444444, 0.4548611111111111, 0.4618055555555555, 0.4696180555555555, 0.4774305555555555, 0.4852430555555555, 0.4913194444444444, 0.49652777777777773]
    # Cld_t_098 = [0.9510204081632653, 0.9545189504373178, 0.956268221574344, 0.9527696793002915, 0.9580174927113703, 0.9597667638483965, 0.9597667638483965, 0.9597667638483965, 0.9597667638483965, 0.9597667638483965, 0.9615160349854227, 0.9615160349854227, 0.963265306122449, 0.9650145772594753, 0.9650145772594753, 0.9650145772594753, 0.9650145772594753, 0.9685131195335277, 0.9685131195335277, 0.9685131195335277, 0.9685131195335277, 0.970262390670554, 0.9720116618075801, 0.9720116618075801, 0.9720116618075801, 0.9720116618075801, 0.9737609329446064, 0.9720116618075801, 0.9737609329446064, 0.9755102040816327, 0.9737609329446064, 0.9755102040816327, 0.9755102040816327, 0.9755102040816327, 0.9755102040816327, 0.9755102040816327, 0.9755102040816327, 0.9807580174927114, 0.9772594752186589, 0.9772594752186589, 0.9772594752186589, 0.9772594752186589, 0.9772594752186589, 0.9772594752186589, 0.9790087463556851, 0.9790087463556851, 0.9790087463556851, 0.9790087463556851, 0.9790087463556851, 0.9790087463556851, 0.9755102040816327, 0.9807580174927114]

    # fitGraph(cf_c_098, Cld_t_098, 4, "Cld_098")
    # save_coefs([ 0.31489457, -0.26165478, -0.08271601,  0.13248927,  0.94637163], "Cld_t_098", "Cld_t")

    # cf_c_084 = [0.05295138888888889, 0.059027777777777776, 0.0642361111111111, 0.0703125, 0.07638888888888888, 0.08072916666666666, 0.08940972222222222, 0.09461805555555555, 0.10243055555555555, 0.11024305555555555, 0.11805555555555555, 0.125, 0.1328125, 0.1388888888888889, 0.14583333333333331, 0.15277777777777776, 0.16059027777777776, 0.16927083333333331, 0.17621527777777776, 0.18229166666666666, 0.19010416666666666, 0.19618055555555555, 0.203125, 0.2109375, 0.21875, 0.22569444444444442, 0.23177083333333331, 0.23958333333333331, 0.24826388888888887, 0.2552083333333333, 0.2638888888888889, 0.2717013888888889, 0.2803819444444444, 0.2873263888888889, 0.2960069444444444, 0.3029513888888889, 0.30902777777777773, 0.3159722222222222, 0.32291666666666663, 0.3315972222222222, 0.3376736111111111, 0.3446180555555555, 0.3524305555555555, 0.3585069444444444, 0.3663194444444444, 0.3732638888888889, 0.3802083333333333, 0.38715277777777773, 0.3940972222222222, 0.40104166666666663, 0.4071180555555555, 0.4140625, 0.42013888888888884, 0.4314236111111111, 0.4314236111111111, 0.4383680555555555, 0.4461805555555555, 0.453125, 0.4600694444444444, 0.4678819444444444, 0.47482638888888884, 0.4861111111111111, 0.49652777777777773]
    # Cld_t_084 = [0.6588921282798834, 0.6641399416909621, 0.6693877551020408, 0.6763848396501457, 0.678134110787172, 0.6833819241982507, 0.6886297376093294, 0.6938775510204082, 0.6956268221574344, 0.7008746355685131, 0.7043731778425656, 0.707871720116618, 0.7131195335276967, 0.714868804664723, 0.714868804664723, 0.7201166180758017, 0.721865889212828, 0.7236151603498542, 0.7253644314868805, 0.7288629737609329, 0.7288629737609329, 0.7306122448979592, 0.7323615160349854, 0.7341107871720116, 0.7393586005830903, 0.7411078717201167, 0.7411078717201167, 0.7428571428571429, 0.7463556851311954, 0.7481049562682216, 0.7481049562682216, 0.7533527696793003, 0.7533527696793003, 0.7551020408163265, 0.7551020408163265, 0.7568513119533529, 0.758600583090379, 0.7603498542274052, 0.7620991253644316, 0.7638483965014577, 0.7655976676384839, 0.7655976676384839, 0.7673469387755103, 0.7708454810495626, 0.7708454810495626, 0.772594752186589, 0.772594752186589, 0.7760932944606413, 0.7760932944606413, 0.7778425655976677, 0.7813411078717201, 0.7813411078717201, 0.7813411078717201, 0.7830903790087465, 0.7830903790087465, 0.7848396501457726, 0.7883381924198252, 0.7883381924198252, 0.7918367346938775, 0.7935860058309039, 0.7935860058309039, 0.79533527696793, 0.7970845481049562]

    # fitGraph(cf_c_084, Cld_t_084, 4, "Cld_084")
    # save_coefs([-7.44014254, 10.11408234, -5.05865866,  1.31736998,  0.60376918], "Cld_t_084", "Cld_t")

    # cf_c_078 = [0.05208333333333333, 0.059027777777777776, 0.06597222222222222, 0.07378472222222222, 0.08072916666666666, 0.08680555555555555, 0.09461805555555555, 0.1015625, 0.11024305555555555, 0.1189236111111111, 0.1267361111111111, 0.13368055555555555, 0.1440972222222222, 0.15451388888888887, 0.16493055555555555, 0.17708333333333331, 0.18489583333333331, 0.19357638888888887, 0.20225694444444442, 0.21180555555555555, 0.22135416666666666, 0.22916666666666666, 0.23871527777777776, 0.2439236111111111, 0.25260416666666663, 0.2595486111111111, 0.2664930555555555, 0.2725694444444444, 0.2795138888888889, 0.2864583333333333, 0.2942708333333333, 0.30121527777777773, 0.3098958333333333, 0.3159722222222222, 0.3220486111111111, 0.3298611111111111, 0.33854166666666663, 0.3472222222222222, 0.35590277777777773, 0.36371527777777773, 0.3723958333333333, 0.3819444444444444, 0.390625, 0.3984375, 0.40625, 0.4131944444444444, 0.4210069444444444, 0.42795138888888884, 0.43576388888888884, 0.4444444444444444, 0.453125, 0.4626736111111111, 0.4704861111111111, 0.48090277777777773, 0.48871527777777773, 0.4956597222222222]
    # Cld_t_078 = [0.5276967930029155, 0.5329446064139942, 0.5381924198250729, 0.5469387755102041, 0.5521865889212828, 0.5574344023323615, 0.5626822157434402, 0.567930029154519, 0.574927113702624, 0.574927113702624, 0.5871720116618075, 0.5871720116618075, 0.5906705539358601, 0.5959183673469388, 0.6029154518950437, 0.6029154518950437, 0.6081632653061224, 0.6151603498542274, 0.6151603498542274, 0.6169096209912537, 0.6221574344023324, 0.6256559766763848, 0.6274052478134111, 0.6309037900874636, 0.6309037900874636, 0.634402332361516, 0.641399416909621, 0.6396501457725947, 0.6431486880466473, 0.6448979591836734, 0.6466472303206997, 0.6518950437317784, 0.6518950437317784, 0.6536443148688047, 0.6571428571428571, 0.6571428571428571, 0.6606413994169096, 0.6623906705539359, 0.6676384839650146, 0.6676384839650146, 0.671137026239067, 0.671137026239067, 0.6746355685131196, 0.678134110787172, 0.6798833819241983, 0.6798833819241983, 0.6833819241982507, 0.685131195335277, 0.6833819241982507, 0.6868804664723032, 0.6886297376093294, 0.6921282798833819, 0.6938775510204082, 0.6956268221574344, 0.6991253644314869, 0.7008746355685131]

    # fitGraph(cf_c_078, Cld_t_078, 4, "Cld_078")
    # save_coefs([-6.57936124,  8.70387513, -4.42133854,  1.31452314,  0.47042494], "Cld_t_078", "Cld_t")

    # cf_c_09 = [0.05208333333333333, 0.057291666666666664, 0.06336805555555555, 0.0703125, 0.07725694444444443, 0.08506944444444443, 0.09288194444444443, 0.09895833333333333, 0.10503472222222221, 0.11371527777777778, 0.12065972222222221, 0.1267361111111111, 0.13368055555555555, 0.14322916666666666, 0.1501736111111111, 0.15625, 0.16666666666666666, 0.17274305555555555, 0.1814236111111111, 0.1892361111111111, 0.1970486111111111, 0.2048611111111111, 0.2109375, 0.21788194444444442, 0.22395833333333331, 0.23350694444444442, 0.2421875, 0.25, 0.2569444444444444, 0.2647569444444444, 0.2725694444444444, 0.28125, 0.2890625, 0.2977430555555555, 0.3038194444444444, 0.3116319444444444, 0.3185763888888889, 0.3255208333333333, 0.33246527777777773, 0.34027777777777773, 0.34809027777777773, 0.35590277777777773, 0.36371527777777773, 0.3723958333333333, 0.3802083333333333, 0.38715277777777773, 0.39496527777777773, 0.40104166666666663, 0.4079861111111111, 0.4192708333333333, 0.4270833333333333, 0.43402777777777773, 0.4427083333333333, 0.45138888888888884, 0.4583333333333333, 0.4661458333333333, 0.47482638888888884, 0.48263888888888884, 0.4913194444444444, 0.4973958333333333]
    # Cld_t_09 = [0.7848396501457726, 0.7883381924198252, 0.7900874635568513, 0.79533527696793, 0.79533527696793, 0.8023323615160349, 0.8058309037900875, 0.8075801749271136, 0.80932944606414, 0.8128279883381924, 0.8163265306122449, 0.8163265306122449, 0.8198250728862975, 0.8215743440233236, 0.8233236151603498, 0.8268221574344023, 0.8268221574344023, 0.8285714285714285, 0.8320699708454811, 0.8338192419825072, 0.8355685131195336, 0.8355685131195336, 0.8373177842565598, 0.8408163265306123, 0.8408163265306123, 0.8425655976676385, 0.8443148688046647, 0.8443148688046647, 0.8478134110787172, 0.8478134110787172, 0.8495626822157434, 0.8530612244897959, 0.8513119533527698, 0.8548104956268221, 0.8565597667638485, 0.8565597667638485, 0.8583090379008746, 0.8600583090379008, 0.8600583090379008, 0.8618075801749272, 0.8618075801749272, 0.8653061224489795, 0.8653061224489795, 0.8653061224489795, 0.8670553935860059, 0.8670553935860059, 0.8670553935860059, 0.8705539358600582, 0.8705539358600582, 0.8705539358600582, 0.8723032069970846, 0.8740524781341108, 0.8740524781341108, 0.8740524781341108, 0.8740524781341108, 0.875801749271137, 0.875801749271137, 0.8775510204081634, 0.8775510204081634, 0.8775510204081634]

    # fitGraph(cf_c_09, Cld_t_09, 4, "Cld_09")
    # save_coefs([-4.14329494,  5.22107478, -2.60883147,  0.76749809,  0.75179737], "Cld_t_09", "Cld_t")

    # fit dos coeficientes de Cl_d_t ===========================================================================================
    # Cld_t = get_json("Cld_t")
    # multifit([0.7, 0.78, 0.84, 0.9, 0.98], 3, Cld_t["Cld_t_07"], Cld_t["Cld_t_078"], Cld_t["Cld_t_084"], Cld_t["Cld_t_09"], Cld_t["Cld_t_098"])

    # cf_c = np.linspace(0, 0.5)
    # plt.plot(cf_c, np.polyval(Cld_098, cf_c))
    # plt.plot(cf_c, np.polyval(Cld_09, cf_c))
    # plt.plot(cf_c, np.polyval(Cld_084, cf_c))
    # plt.plot(cf_c, np.polyval(Cld_078, cf_c))
    # plt.plot(cf_c, np.polyval(Cld_07, cf_c))
    # plt.show()

    ## K1 =============================================================================================
    def k1 (x, a, b, c, d, e, f):
        return a/(b*np.log(c*np.array(x) + d) + e) + f
    # def k1 (x, a, b, c, d):
    #     return a/(x**b) + c/(x**d)

    # funcionou
    # Aw_01 = [1.420345489443378, 1.4779270633397312, 1.5163147792706333, 1.5738963531669865, 1.5930902111324374, 1.6698656429942418, 1.7274472168905948, 1.82341650671785, 1.8618042226487523, 1.9385796545105565, 1.9961612284069097, 2.092130518234165, 2.149712092130518, 2.226487523992322, 2.2840690978886755, 2.3608445297504796, 2.4184261036468326, 2.533589251439539, 2.610364683301343, 2.7447216890595008, 2.8023032629558537, 2.91746641074856, 2.9750479846449136, 3.0902111324376196, 3.1669865642994237, 3.2437619961612283, 3.3397312859884836, 3.4548944337811895, 3.589251439539347, 3.6852207293666024, 3.7811900191938577, 3.9155470249520152, 4.069097888675623, 4.18426103646833, 4.337811900191938, 4.472168905950095, 4.644913627639155, 4.798464491362764, 4.894433781190019, 5.047984644913627, 5.201535508637235, 5.316698656429942, 5.431861804222648, 5.508637236084453, 5.623800383877159, 5.758157389635317, 5.873320537428023, 6.065259117082533, 6.2188099808061414, 6.37236084452975, 6.545105566218809, 6.698656429942418, 6.8522072936660265, 6.9673704414587325, 7.10172744721689, 7.236084452975048, 7.389635316698656, 7.543186180422264, 7.715930902111324, 7.869481765834932, 8.042226487523992, 8.176583493282148, 8.349328214971209, 8.502879078694818, 8.618042226487523, 8.809980806142034, 8.905950095969288, 9.040307101727446, 9.232245681381958, 9.366602687140114, 9.520153550863723, 9.65451055662188, 9.808061420345489, 9.961612284069098]
    # K1_01 = [1.9981060606060606, 1.981060606060606, 1.956439393939394, 1.9375, 1.9166666666666667, 1.8996212121212122, 1.875, 1.8522727272727273, 1.8352272727272727, 1.808712121212121, 1.7878787878787878, 1.768939393939394, 1.753787878787879, 1.7367424242424243, 1.7196969696969697, 1.7045454545454546, 1.6875, 1.6666666666666667, 1.6458333333333335, 1.6268939393939394, 1.6136363636363638, 1.5984848484848486, 1.5833333333333335, 1.5700757575757576, 1.5568181818181819, 1.543560606060606, 1.5340909090909092, 1.5208333333333335, 1.503787878787879, 1.4924242424242424, 1.4791666666666667, 1.4715909090909092, 1.456439393939394, 1.4431818181818181, 1.4318181818181819, 1.4223484848484849, 1.4090909090909092, 1.3996212121212122, 1.384469696969697, 1.378787878787879, 1.3674242424242424, 1.3541666666666667, 1.356060606060606, 1.3446969696969697, 1.3428030303030303, 1.3352272727272727, 1.3276515151515151, 1.316287878787879, 1.308712121212121, 1.303030303030303, 1.2916666666666667, 1.2878787878787878, 1.2821969696969697, 1.2708333333333333, 1.268939393939394, 1.2613636363636362, 1.2556818181818181, 1.2518939393939394, 1.246212121212121, 1.240530303030303, 1.2329545454545454, 1.2329545454545454, 1.2272727272727273, 1.2272727272727273, 1.2215909090909092, 1.2215909090909092, 1.2140151515151516, 1.2140151515151516, 1.2102272727272727, 1.2102272727272727, 1.2083333333333333, 1.206439393939394, 1.2045454545454546, 1.2045454545454546]

    # popt, _ = curve_fit(k1, Aw_01, K1_01, p0=[1.5, 1.4, 1.1, 3, 1.4, 1.3])

    # y = popt[0]/(popt[1]*np.log(popt[2]*np.array(Aw_01) + popt[3]) + popt[4]) + popt[5]

    # print(f"K1_01 = {popt[0]}/({popt[1]}*np.log({popt[2]}*Aw + {popt[3]}) + {popt[4]}) + {popt[5]}")
    # print(f"# r² : {r2_score(K1_01, y)}")

    # save_coefs(popt, "K1_01", "K1")

    # plt.scatter(Aw_01, K1_01, c='k')
    # plt.plot(Aw_01, y, 'r')
    # plt.show()

    # funcionou
    # Aw_02 = [0.6525911708253358, 0.6333973128598848, 0.690978886756238, 0.690978886756238, 0.710172744721689, 0.710172744721689, 0.72936660268714, 0.7485604606525911, 0.7869481765834933, 0.8253358925143953, 0.8445297504798464, 0.8829174664107485, 0.9213051823416506, 0.9788867562380038, 0.9788867562380038, 1.036468330134357, 1.055662188099808, 1.1516314779270633, 1.2092130518234163, 1.2476007677543186, 1.3435700575815739, 1.3627639155470248, 1.4779270633397312, 1.5547024952015354, 1.6314779270633395, 1.7082533589251438, 1.765834932821497, 1.82341650671785, 1.9577735124760076, 1.9961612284069097, 2.0537428023032627, 2.168905950095969, 2.2648752399232244, 2.3224568138195774, 2.437619961612284, 2.514395393474088, 2.6295585412667943, 2.840690978886756, 2.840690978886756, 2.9942418426103643, 3.0902111324376196, 3.2437619961612283, 3.3781190019193854, 3.4548944337811895, 3.589251439539347, 3.7044145873320535, 3.857965451055662, 4.030710172744722, 4.1266794625719765, 4.280230326295585, 4.452975047984644, 4.587332053742802, 4.760076775431862, 4.875239923224568, 5.047984644913627, 5.201535508637235, 5.3742802303262955, 5.4894433781190015, 5.64299424184261, 5.796545105566218, 5.892514395393474, 6.026871401151631, 6.180422264875239, 6.333973128598847, 6.487523992322457, 6.660268714011516, 6.794625719769673, 6.986564299424184, 7.120921305182341, 7.312859884836851, 7.46641074856046, 7.63915547024952, 7.792706333973128, 7.965451055662188, 8.119001919385797, 8.291746641074855, 8.502879078694818, 8.675623800383876, 8.809980806142034, 8.963531669865642, 9.117082533589251, 9.251439539347409, 9.404990403071016, 9.577735124760077, 9.712092130518233, 9.84644913627639]
    # K1_02 = [1.9981060606060606, 1.981060606060606, 1.9640151515151514, 1.941287878787879, 1.9261363636363638, 1.9109848484848486, 1.8882575757575757, 1.871212121212121, 1.856060606060606, 1.8409090909090908, 1.8200757575757576, 1.7954545454545454, 1.7803030303030303, 1.7651515151515151, 1.7386363636363638, 1.7272727272727273, 1.706439393939394, 1.6893939393939394, 1.668560606060606, 1.6515151515151514, 1.6363636363636362, 1.6117424242424243, 1.5965909090909092, 1.581439393939394, 1.558712121212121, 1.5416666666666665, 1.5303030303030303, 1.5208333333333335, 1.5056818181818183, 1.4943181818181819, 1.4829545454545454, 1.4659090909090908, 1.4545454545454546, 1.4375, 1.433712121212121, 1.4261363636363638, 1.4147727272727273, 1.3901515151515151, 1.3901515151515151, 1.375, 1.3636363636363638, 1.3522727272727273, 1.3409090909090908, 1.3295454545454546, 1.321969696969697, 1.3143939393939394, 1.3068181818181819, 1.2954545454545454, 1.2840909090909092, 1.2821969696969697, 1.2708333333333333, 1.2613636363636362, 1.2518939393939394, 1.246212121212121, 1.2386363636363638, 1.2329545454545454, 1.2272727272727273, 1.2196969696969697, 1.2159090909090908, 1.2121212121212122, 1.206439393939394, 1.206439393939394, 1.196969696969697, 1.1893939393939394, 1.1875, 1.1856060606060606, 1.1761363636363638, 1.1723484848484849, 1.1704545454545454, 1.1704545454545454, 1.1666666666666667, 1.1571969696969697, 1.1571969696969697, 1.1571969696969697, 1.1534090909090908, 1.143939393939394, 1.1401515151515151, 1.143939393939394, 1.1382575757575757, 1.1382575757575757, 1.1363636363636362, 1.1363636363636362, 1.1325757575757576, 1.134469696969697, 1.1306818181818181, 1.1306818181818181]

    # popt, _ = curve_fit(k1, Aw_02, K1_02)

    # y = popt[0]/(popt[1]*np.log(popt[2]*np.array(Aw_02) + popt[3]) + popt[4]) + popt[5]

    # print(f"K1_02 = {popt[0]}/({popt[1]}*np.log({popt[2]}*Aw + {popt[3]}) + {popt[4]}) + {popt[5]}")
    # print(f"# r² : {r2_score(K1_02, y)}")

    # save_coefs(popt, "K1_02", "K1")

    # plt.scatter(Aw_02, K1_02, c='k')
    # plt.plot(Aw_02, y, 'r')
    # plt.show()

    # funcionou
    # Aw_04 = [0.019193857965451054, 0.019193857965451054, 0.07677543186180422, 0.07677543186180422, 0.11516314779270632, 0.11516314779270632, 0.15355086372360843, 0.19193857965451055, 0.2111324376199616, 0.26871401151631474, 0.30710172744721687, 0.3262955854126679, 0.36468330134357, 0.3838771593090211, 0.44145873320537427, 0.4606525911708253, 0.5182341650671785, 0.5758157389635317, 0.6142034548944337, 0.690978886756238, 0.7677543186180422, 0.7677543186180422, 0.8637236084452974, 0.9404990403071016, 1.0172744721689058, 1.113243761996161, 1.2092130518234163, 1.2859884836852207, 1.420345489443378, 1.5355086372360844, 1.6506717850287906, 1.765834932821497, 1.8426103646833012, 1.9577735124760076, 2.072936660268714, 2.168905950095969, 2.2840690978886755, 2.380038387715931, 2.514395393474088, 2.6679462571976966, 2.763915547024952, 2.898272552783109, 3.0518234165067177, 3.205374280230326, 3.3205374280230324, 3.4548944337811895, 3.570057581573896, 3.7044145873320535, 3.8387715930902107, 3.953934740882917, 4.088291746641074, 4.203454894433781, 4.357005758157389, 4.472168905950095, 4.6257197696737045, 4.779270633397313, 5.009596928982725, 5.009596928982725, 5.163147792706334, 5.412667946257197, 5.585412667946256, 5.758157389635317, 5.892514395393474, 6.046065259117082, 6.19961612284069, 6.391554702495201, 6.56429942418426, 6.7178502879078685, 6.890595009596929, 7.044145873320537, 7.178502879078694, 7.312859884836851, 7.485604606525911, 7.619961612284069, 7.773512476007677, 7.927063339731285, 8.119001919385797, 8.272552783109404, 8.445297504798464, 8.598848368522072, 8.752399232245681, 8.92514395393474, 9.0978886756238, 9.232245681381958, 9.366602687140114, 9.520153550863723, 9.67370441458733, 9.865642994241842]
    # K1_04 = [1.8446969696969697, 1.821969696969697, 1.8030303030303032, 1.7859848484848486, 1.7575757575757576, 1.7386363636363638, 1.7159090909090908, 1.6931818181818183, 1.668560606060606, 1.6515151515151514, 1.634469696969697, 1.6136363636363638, 1.6003787878787878, 1.581439393939394, 1.566287878787879, 1.5492424242424243, 1.5340909090909092, 1.5170454545454546, 1.4981060606060606, 1.4829545454545454, 1.4621212121212122, 1.4431818181818181, 1.4299242424242424, 1.4090909090909092, 1.3920454545454546, 1.3731060606060606, 1.3579545454545454, 1.3390151515151516, 1.3238636363636362, 1.3049242424242424, 1.2878787878787878, 1.2765151515151516, 1.2613636363636362, 1.2518939393939394, 1.2424242424242424, 1.2329545454545454, 1.2253787878787878, 1.2159090909090908, 1.206439393939394, 1.1988636363636365, 1.191287878787879, 1.183712121212121, 1.178030303030303, 1.1704545454545454, 1.1628787878787878, 1.1609848484848484, 1.1515151515151516, 1.1496212121212122, 1.1420454545454546, 1.1420454545454546, 1.1382575757575757, 1.1306818181818181, 1.1306818181818181, 1.1231060606060606, 1.1231060606060606, 1.1174242424242424, 1.1136363636363638, 1.1136363636363638, 1.106060606060606, 1.106060606060606, 1.1022727272727273, 1.1003787878787878, 1.0946969696969697, 1.0928030303030303, 1.0928030303030303, 1.0890151515151516, 1.0852272727272727, 1.0833333333333333, 1.0833333333333333, 1.0795454545454546, 1.0776515151515151, 1.0776515151515151, 1.0738636363636365, 1.0738636363636365, 1.0776515151515151, 1.0738636363636365, 1.0681818181818181, 1.0700757575757576, 1.0700757575757576, 1.066287878787879, 1.066287878787879, 1.066287878787879, 1.066287878787879, 1.0625, 1.0625, 1.0625, 1.058712121212121, 1.058712121212121]

    # popt, _ = curve_fit(k1, Aw_04, K1_04)

    # y = popt[0]/(popt[1]*np.log(popt[2]*np.array(Aw_04) + popt[3]) + popt[4]) + popt[5]

    # print(f"K1_04 = {popt[0]}/({popt[1]}*np.log({popt[2]}*Aw + {popt[3]}) + {popt[4]}) + {popt[5]}")
    # print(f"# r² : {r2_score(K1_04, y)}")

    # save_coefs(popt, "K1_04", "K1")

    # plt.scatter(Aw_04, K1_04, c='k')
    # plt.plot(Aw_04, y, 'r')
    # plt.show()

    # funcionou
    # Aw_06 = [ 0.019193857965451054, 0.05758157389635316, 0.05758157389635316, 0.07677543186180422, 0.11516314779270632, 0.11516314779270632, 0.13435700575815737, 0.15355086372360843, 0.19193857965451055, 0.23032629558541265, 0.2495201535508637, 0.30710172744721687, 0.36468330134357, 0.36468330134357, 0.4222648752399232, 0.4990403071017274, 0.5374280230326295, 0.5950095969289827, 0.6142034548944337, 0.690978886756238, 0.8253358925143953, 0.9021113243761996, 1.036468330134357, 1.1708253358925143, 1.3243761996161227, 1.4011516314779269, 1.5163147792706333, 1.6314779270633395, 1.785028790786948, 1.8809980806142033, 2.0345489443378115, 2.2072936660268714, 2.3416506717850285, 2.55278310940499, 2.6487523992322455, 2.783109404990403, 2.91746641074856, 3.0902111324376196, 3.2437619961612283, 3.435700575815739, 3.6084452975047983, 3.7428023032629554, 3.877159309021113, 4.049904030710173, 4.241842610364683, 4.414587332053743, 4.6257197696737045, 4.798464491362764, 4.971209213051823, 5.143953934740883, 5.297504798464491, 5.47024952015355, 5.700575815738963, 5.873320537428023, 6.046065259117082, 6.19961612284069, 6.410748560460652, 6.56429942418426, 6.73704414587332, 6.948176583493281, 7.140115163147792, 7.3320537428023025, 7.46641074856046, 7.619961612284069, 7.811900191938579, 8.00383877159309, 8.157389635316697, 8.330134357005758, 8.57965451055662, 8.752399232245681, 8.94433781190019, 9.193857965451055, 9.443378119001919, 9.692898272552782, 9.923224568138195]
    # K1_06 = [ 1.5776515151515151, 1.5549242424242424, 1.5284090909090908, 1.5075757575757576, 1.490530303030303, 1.4734848484848486, 1.4583333333333335, 1.4431818181818181, 1.4204545454545454, 1.4071969696969697, 1.3863636363636362, 1.365530303030303, 1.3522727272727273, 1.3371212121212122, 1.3200757575757576, 1.3049242424242424, 1.2878787878787878, 1.2727272727272727, 1.259469696969697, 1.246212121212121, 1.2329545454545454, 1.2178030303030303, 1.2026515151515151, 1.1856060606060606, 1.1799242424242424, 1.168560606060606, 1.1553030303030303, 1.1534090909090908, 1.1458333333333333, 1.1382575757575757, 1.1306818181818181, 1.121212121212121, 1.1136363636363638, 1.1136363636363638, 1.1041666666666667, 1.1003787878787878, 1.0928030303030303, 1.0909090909090908, 1.0871212121212122, 1.0795454545454546, 1.0757575757575757, 1.071969696969697, 1.071969696969697, 1.066287878787879, 1.0643939393939394, 1.058712121212121, 1.0606060606060606, 1.0549242424242424, 1.0511363636363635, 1.0492424242424243, 1.0492424242424243, 1.0473484848484849, 1.0454545454545454, 1.0473484848484849, 1.043560606060606, 1.043560606060606, 1.0416666666666667, 1.0416666666666667, 1.0397727272727273, 1.0397727272727273, 1.0378787878787878, 1.0378787878787878, 1.0321969696969697, 1.0340909090909092, 1.0340909090909092, 1.0340909090909092, 1.0303030303030303, 1.0303030303030303, 1.0303030303030303, 1.0303030303030303, 1.0265151515151516, 1.0246212121212122, 1.0246212121212122, 1.0246212121212122, 1.0246212121212122]
    # # -0.019193857965451054
    # # 1.6022727272727273

    # popt, _ = curve_fit(k1, Aw_06, K1_06)

    # y = popt[0]/(popt[1]*np.log(popt[2]*np.array(Aw_06) + popt[3]) + popt[4]) + popt[5]

    # print(f"K1_06 = {popt[0]}/({popt[1]}*np.log({popt[2]}*Aw + {popt[3]}) + {popt[4]}) + {popt[5]}")
    # print(f"# r² : {r2_score(K1_06, y)}")

    # save_coefs(popt, "K1_06", "K1")

    # plt.figure()
    # plt.scatter(Aw_06, K1_06, c='k')
    # plt.plot(Aw_06, y, 'r')
    # plt.show()

    # funcionou
    # Aw_07 = [ 0, 0.019193857965451054, 0.019193857965451054, 0.05758157389635316, 0.07677543186180422, 0.07677543186180422, 0.09596928982725528, 0.13435700575815737, 0.1727447216890595, 0.2111324376199616, 0.2111324376199616, 0.2495201535508637, 0.26871401151631474, 0.345489443378119, 0.40307101727447214, 0.47984644913627633, 0.5374280230326295, 0.6333973128598848, 0.72936660268714, 0.8253358925143953, 0.9213051823416506, 1.074856046065259, 1.1900191938579654, 1.3243761996161227, 1.4779270633397312, 1.6314779270633395, 1.785028790786948, 1.9577735124760076, 2.111324376199616, 2.2840690978886755, 2.4184261036468326, 2.5719769673704413, 2.7255278310940496, 2.8790786948176583, 3.0518234165067177, 3.205374280230326, 3.3781190019193854, 3.531669865642994, 3.6852207293666024, 3.8387715930902107, 3.9923224568138194, 4.165067178502879, 4.337811900191938, 4.5489443378119, 4.779270633397313, 4.952015355086372, 5.10556621880998, 5.297504798464491, 5.508637236084453, 5.681381957773512, 5.873320537428023, 6.046065259117082, 6.2188099808061414, 6.391554702495201, 6.56429942418426, 6.73704414587332, 6.890595009596929, 7.10172744721689, 7.27447216890595, 7.504798464491362, 7.735124760076775, 7.984644913627639, 8.176583493282148, 8.349328214971209, 8.522072936660267, 8.73320537428023, 8.867562380038388, 9.078694817658349, 9.28982725527831, 9.46257197696737, 9.65451055662188, 9.788867562380037, 9.923224568138195]
    # K1_07 = [ 1.4393939393939394, 1.4242424242424243, 1.4053030303030303, 1.3882575757575757, 1.3674242424242424, 1.356060606060606, 1.3371212121212122, 1.321969696969697, 1.3049242424242424, 1.293560606060606, 1.2803030303030303, 1.2670454545454546, 1.2518939393939394, 1.2367424242424243, 1.2234848484848484, 1.2045454545454546, 1.1931818181818181, 1.1799242424242424, 1.1704545454545454, 1.1590909090909092, 1.1458333333333333, 1.1401515151515151, 1.1306818181818181, 1.1231060606060606, 1.1136363636363638, 1.106060606060606, 1.1003787878787878, 1.0946969696969697, 1.0871212121212122, 1.0833333333333333, 1.081439393939394, 1.0738636363636365, 1.0700757575757576, 1.0700757575757576, 1.0643939393939394, 1.0606060606060606, 1.058712121212121, 1.053030303030303, 1.053030303030303, 1.0492424242424243, 1.0492424242424243, 1.0454545454545454, 1.043560606060606, 1.0397727272727273, 1.0378787878787878, 1.0359848484848484, 1.0359848484848484, 1.0340909090909092, 1.0321969696969697, 1.0321969696969697, 1.0321969696969697, 1.0284090909090908, 1.0284090909090908, 1.0303030303030303, 1.0284090909090908, 1.0284090909090908, 1.0265151515151516, 1.0265151515151516, 1.0246212121212122, 1.0246212121212122, 1.0208333333333333, 1.0227272727272727, 1.0208333333333333, 1.0227272727272727, 1.0208333333333333, 1.0170454545454546, 1.0208333333333333, 1.0208333333333333, 1.018939393939394, 1.0170454545454546, 1.018939393939394, 1.0151515151515151, 1.0151515151515151]
    # # -0.019193857965451054
    # # 1.4545454545454546
    # popt, _ = curve_fit(k1, Aw_07, K1_07)

    # y = popt[0]/(popt[1]*np.log(popt[2]*np.array(Aw_07) + popt[3]) + popt[4]) + popt[5]

    # print(f"K1_07 = {popt[0]}/({popt[1]}*np.log({popt[2]}*Aw + {popt[3]}) + {popt[4]}) + {popt[5]}")
    # print(f"# r² : {r2_score(K1_07, y)}")

    # save_coefs(popt, "K1_07", "K1")

    # plt.figure()
    # plt.scatter(Aw_07, K1_07, c='k')
    # plt.plot(Aw_07, y, 'r')
    # plt.show()

    # funcionou
    # Aw_08 = [0, 0.03838771593090211, 0.11516314779270632, 0.15355086372360843, 0.26871401151631474, 0.345489443378119, 0.44145873320537427, 0.5566218809980805, 0.6717850287907869, 0.7869481765834933, 0.9213051823416506, 1.074856046065259, 1.1900191938579654, 1.3243761996161227, 1.45873320537428, 1.6314779270633395, 1.785028790786948, 1.9577735124760076, 2.130518234165067, 2.2648752399232244, 2.4184261036468326, 2.5911708253358925, 2.7447216890595008, 2.91746641074856, 3.0326295585412666, 3.28214971209213, 3.512476007677543, 3.6852207293666024, 3.8387715930902107, 4.030710172744722, 4.222648752399232, 4.3761996161228405, 4.529750479846449, 4.798464491362764, 5.028790786948176, 5.201535508637235, 5.431861804222648, 5.623800383877159, 5.8541266794625715, 6.084452975047984, 6.295585412667946, 6.487523992322457, 6.698656429942418, 6.8522072936660265, 7.063339731285988, 7.236084452975048, 7.46641074856046, 7.677543186180421, 7.888675623800383, 8.061420345489443, 8.272552783109404, 8.522072936660267]
    # K1_08 = [1.2083333333333333, 1.1950757575757576, 1.178030303030303, 1.1647727272727273, 1.1534090909090908, 1.1382575757575757, 1.128787878787879, 1.121212121212121, 1.1079545454545454, 1.1003787878787878, 1.0965909090909092, 1.0852272727272727, 1.0795454545454546, 1.0738636363636365, 1.0700757575757576, 1.0643939393939394, 1.0568181818181819, 1.0568181818181819, 1.0511363636363635, 1.0454545454545454, 1.0454545454545454, 1.0416666666666667, 1.0416666666666667, 1.0378787878787878, 1.0378787878787878, 1.0340909090909092, 1.0340909090909092, 1.0303030303030303, 1.0265151515151516, 1.0321969696969697, 1.0265151515151516, 1.0246212121212122, 1.0246212121212122, 1.018939393939394, 1.018939393939394, 1.018939393939394, 1.018939393939394, 1.0132575757575757, 1.0132575757575757, 1.0132575757575757, 1.0132575757575757, 1.0113636363636365, 1.0075757575757576, 1.009469696969697, 1.009469696969697, 1.009469696969697, 1.0056818181818181, 1.009469696969697, 1.0075757575757576, 1.0075757575757576, 1.0075757575757576, 1.0056818181818181]
    # popt, _ = curve_fit(k1, Aw_08, K1_08)

    # y = popt[0]/(popt[1]*np.log(popt[2]*np.array(Aw_08) + popt[3]) + popt[4]) + popt[5]

    # print(f"K1_08 = {popt[0]}/({popt[1]}*np.log({popt[2]}*Aw + {popt[3]}) + {popt[4]}) + {popt[5]}")
    # print(f"# r² : {r2_score(K1_08, y)}")

    # save_coefs(popt, "K1_08", "K1")

    # plt.scatter(Aw_08, K1_08, c='k')
    # plt.plot(Aw_08, y, 'r')
    # plt.show()

    # funcionou
    # Aw_09 = [0, 0.09596928982725528, 0.19193857965451055, 0.345489443378119, 0.47984644913627633, 0.6333973128598848, 0.7869481765834933, 0.9596928982725527, 1.113243761996161, 1.3051823416506716, 1.45873320537428, 1.6506717850287906, 1.8809980806142033, 2.0537428023032627, 2.2456813819577732, 2.380038387715931, 2.533589251439539]
    # K1_09 = [1.1098484848484849, 1.0984848484848484, 1.0871212121212122, 1.0738636363636365, 1.0681818181818181, 1.058712121212121, 1.053030303030303, 1.0454545454545454, 1.043560606060606, 1.043560606060606, 1.0378787878787878, 1.0340909090909092, 1.0303030303030303, 1.0284090909090908, 1.0227272727272727, 1.0208333333333333, 1.018939393939394]

    # popt, _ = curve_fit(k1, Aw_09, K1_09, p0=[0.5, 0.4, 0.1, 2, 0.4, 0.3])

    # y = popt[0]/(popt[1]*np.log(popt[2]*np.array(Aw_09) + popt[3]) + popt[4]) + popt[5]

    # print(f"K1_09 = {popt[0]}/({popt[1]}*np.log({popt[2]}*Aw + {popt[3]}) + {popt[4]}) + {popt[5]}")
    # print(f"# r² : {r2_score(K1_09, y)}")

    # save_coefs(popt, "K1_09", "K1")

    # plt.scatter(Aw_09, K1_09, c='k')
    # plt.plot(Aw_09, y, 'r')
    # plt.show()

    # fit dos coeficientes de K1 ===============================================================================================
    # k1 = get_json("K1")

    # multifit([-0.1, -0.2, -0.4, -0.6, -0.7, -0.8, -0.9], 3, k1['K1_01'], k1['K1_02'], k1['K1_04'], k1['K1_06'], k1['K1_07'], k1['K1_08'], k1['K1_09'])

    # interpolação com dataframe ===============================================================================================
    import pandas as pd

    dt = pd.DataFrame(columns=["ag_Cl", "Aw", "K1"])

    k1 = get_json("K1")
    Aw = np.linspace(0.5, 10, 200)
    ag_Cl = ["01", "02", "04", "06", "07", "08", "09"]

    # plt.figure()

    for ag in ag_Cl:
        co = k1[f"K1_{ag}"]
        
        for aw in Aw:
            dt.loc[len(dt)] = [-float(ag)/10, aw, co[0]/(co[1]*np.log(co[2]*aw + co[3]) + co[4]) + co[5]]
        plt.plot(Aw, co[0]/(co[1]*np.log(co[2]*Aw + co[3]) + co[4]) + co[5])

    plt.xlabel('AR')
    plt.ylabel('K1')
    plt.ylim([1, 2])
    plt.xlim([0, 10])
    plt.legend(["$(\\alpha_{\delta})_{Cl}$ = "+str(-float(ag)/10) for ag in ag_Cl])
    plt.grid()

    # dt.to_json("Util/K1_data.json")

    print(dt)
    plt.show()

